<!-- 导航卡片通用模块 -->
<!-- 网站分类卡片组件 -->
<div class="website-card-component">
    <!-- 网站卡片模板 -->
    <template id="website-card-template">
        <div class="col-md-4 col-sm-6 col-12 mb-3">
            <div class="website-card h-100">
                <div class="website-card-content d-flex align-items-center p-3">
                    <!-- 左侧Logo -->
                    <div class="website-logo me-3 flex-shrink-0">
                        <img src="" alt="网站图标" class="card-logo">
                    </div>
                    <!-- 右侧内容 -->
                    <div class="website-info flex-grow-1 min-width-0">
                        <div class="website-name fw-bold mb-1 text-truncate"></div>
                        <div class="website-desc text-muted small"></div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- 分类区域模板 -->
    <template id="category-section-template">
        <section class="category-section">
            <header class="section-title d-flex justify-content-between align-items-center">
                <div>
                    <i class="bi"></i> <span class="title-text"></span>
                </div>
                <a href="#" class="text-decoration-none small d-none d-sm-inline">
                    查看更多 <i class="bi bi-chevron-right"></i>
                </a>
            </header>
            <div class="card-container row g-2 g-md-3"></div>
        </section>
    </template>

    <!-- 国家/地区站点卡片模板 -->
    <template id="country-card-template">
        <li class="country-item col-6 col-sm-4 col-md-3 col-lg-2">
            <a href="#" class="country-link text-decoration-none">
                <div class="country-card-content p-2 text-center">
                    <span class="country-icon d-block mb-1">
                        <img src="" alt="" class="country-img" width="32" height="24">
                    </span>
                    <span class="country-name small text-truncate d-block"></span>
                </div>
            </a>
        </li>
    </template>
</div>

<!-- 卡片组件的JavaScript -->
<script>
    
    
    // 立即定义函数，不等待DOM加载
    function createWebsiteCard(name, description, iconUrl, link = "#", columnClass = "col-md-4") {
        
        
        // 克隆网站卡片模板
        const template = document.getElementById('website-card-template');
        if (!template) {
            console.error('找不到网站卡片模板');
            return null;
        }
        
        const card = template.content.cloneNode(true);
        
        // 设置卡片内容
        const nameElement = card.querySelector('.website-name');
        const descElement = card.querySelector('.website-desc');
        const logoElement = card.querySelector('.card-logo');
        const cardElement = card.querySelector('.website-card');
        
        // 设置网站名称（最多8个字，超出显示...）
        if (nameElement) {
            nameElement.textContent = name.length > 8 ? name.substring(0, 8) + '...' : name;
        }
        
        // 设置网站描述（最多12个字，超出显示...）
        if (descElement) {
            descElement.textContent = description && description.length > 12 ? description.substring(0, 12) + '...' : description;
        }
        
        // 设置Logo
        if (logoElement) {
            if (iconUrl && iconUrl.startsWith('http')) {
                logoElement.src = iconUrl;
            } else if (link && link !== "#") {
                logoElement.src = `https://www.google.com/s2/favicons?domain=${new URL(link).hostname}&sz=32`;
            } else {
                logoElement.src = `https://www.google.com/s2/favicons?domain=example.com&sz=32`;
            }
            logoElement.alt = `${name}图标`;
        }
        
        // 设置链接和点击事件
        if (cardElement && link !== "#") {
            cardElement.onclick = () => window.open(link, '_blank');
            cardElement.style.cursor = 'pointer';
            cardElement.classList.add('clickable');
        }
        
        return card;
    }
    
    // 创建分类区域的函数
    function createCategorySection(title, iconClass, cards) {
        
        // 克隆分类区域模板
        const template = document.getElementById('category-section-template');
        const section = template.content.cloneNode(true);
        
        // 设置分类标题和图标
        section.querySelector('.title-text').textContent = title;
        section.querySelector('.bi').className = `bi ${iconClass}`;
        
        // 添加卡片到容器
        const container = section.querySelector('.card-container');
        cards.forEach(card => {
            container.appendChild(card);
        });
        
        return section;
    }
    
    // 创建国家/地区站点卡片的函数
    function createCountryCard(name, iconUrl, link = "#") {
        
        
        // 克隆国家卡片模板
        const template = document.getElementById('country-card-template');
        if (!template) {
            console.error('找不到国家卡片模板');
            return null;
        }
        
        const card = template.content.cloneNode(true);
        
        // 设置卡片内容
        const nameElement = card.querySelector('.country-name');
        const iconElement = card.querySelector('.country-img');
        const linkElement = card.querySelector('.country-link');
        
        if (nameElement) nameElement.textContent = name;
        if (iconElement) {
            iconElement.src = iconUrl;
            iconElement.alt = `${name}图标`;
        }
        if (linkElement && link !== "#") {
            linkElement.href = link;
            linkElement.target = '_blank';
        }
        
        return card;
    }
    
    // 创建国家站点集合的函数
    function createCountrySites(countries) {
        
        
        const container = document.createElement('div');
        container.className = 'country-sites-container';
        
        const row = document.createElement('div');
        row.className = 'row g-2';
        
        const innerRow = document.createElement('ul');
        innerRow.className = 'row g-2 list-unstyled';
        
        countries.forEach(country => {
            innerRow.appendChild(createCountryCard(country.name, country.icon, country.link));
        });
        
        const siteCard = document.createElement('div');
        siteCard.className = 'site-card p-3';
        
        siteCard.appendChild(innerRow);
        
        const col = document.createElement('div');
        col.className = 'col-12';
        col.appendChild(siteCard);
        
        row.appendChild(col);
        container.appendChild(row);
        
        return container;
    }

    // 立即将所有函数绑定到window对象，确保全局可访问
    window.createWebsiteCard = createWebsiteCard;
    window.createCategorySection = createCategorySection;
    window.createCountryCard = createCountryCard;
    window.createCountrySites = createCountrySites;
</script>